<<<<<<< Updated upstream
!function(e,o){if("object"==typeof exports&&"object"==typeof module)module.exports=o();else if("function"==typeof define&&define.amd)define([],o);else{var t=o();for(var i in t)("object"==typeof exports?exports:e)[i]=t[i]}}(window,function(){return function(e){var o={};function t(i){if(o[i])return o[i].exports;var s=o[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,t),s.l=!0,s.exports}return t.m=e,t.c=o,t.d=function(e,o,i){t.o(e,o)||Object.defineProperty(e,o,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,o){if(1&o&&(e=t(e)),8&o)return e;if(4&o&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&o&&"string"!=typeof e)for(var s in e)t.d(i,s,function(o){return e[o]}.bind(null,s));return i},t.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(o,"a",o),o},t.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},t.p="",t(t.s=0)}([function(e,o,t){"use strict";t.r(o);var i={Backquote:{code:"Backquote",keyCode:192},Minus:{code:"Minus",keyCode:189},Equal:{code:"Equal",keyCode:187},BracketLeft:{code:"BracketLeft",keyCode:219},BracketRight:{code:"BracketRight",keyCode:221},Backslash:{code:"Backslash",keyCode:220},Semicolon:{code:"Semicolon",keyCode:186},Quote:{code:"Quote",keyCode:222},Comma:{code:"Comma",keyCode:188},Period:{code:"Period",keyCode:190},Slash:{code:"Slash",keyCode:191},AltLeft:{code:"AltLeft",keyCode:18},Home:{code:"Home",keyCode:36},End:{code:"End",keyCode:35},CapsLock:{code:"CapsLock",keyCode:20},ShiftLeft:{code:"ShiftLeft",keyCode:16},ShiftRight:{code:"ShiftRight",keyCode:16},Space:{code:"Space",keyCode:32},ArrowLeft:{code:"ArrowLeft",keyCode:37},ArrowUp:{code:"ArrowUp",keyCode:38},ArrowRight:{code:"ArrowRight",keyCode:39},ArrowDown:{code:"ArrowDown",keyCode:40},Backspace:{code:"Backspace",keyCode:8},Delete:{code:"Delete",keyCode:46},Tab:{code:"Tab",keyCode:9},Digit1:{code:"Digit1",keyCode:49},Digit2:{code:"Digit2",keyCode:50},Digit3:{code:"Digit3",keyCode:51},Digit4:{code:"Digit4",keyCode:52},Digit5:{code:"Digit5",keyCode:53},Digit6:{code:"Digit6",keyCode:54},Digit7:{code:"Digit7",keyCode:55},Digit8:{code:"Digit8",keyCode:56},Digit9:{code:"Digit9",keyCode:57},Digit0:{code:"Digit0",keyCode:48},KeyA:{code:"KeyA",keyCode:65},KeyB:{code:"KeyB",keyCode:66},KeyC:{code:"KeyC",keyCode:67},KeyD:{code:"KeyD",keyCode:68},KeyE:{code:"KeyE",keyCode:69},KeyF:{code:"KeyF",keyCode:70},KeyG:{code:"KeyG",keyCode:71},KeyH:{code:"KeyH",keyCode:72},KeyI:{code:"KeyI",keyCode:73},KeyJ:{code:"KeyJ",keyCode:74},KeyK:{code:"KeyK",keyCode:75},KeyL:{code:"KeyL",keyCode:76},KeyM:{code:"KeyM",keyCode:77},KeyN:{code:"KeyN",keyCode:78},KeyO:{code:"KeyO",keyCode:79},KeyP:{code:"KeyP",keyCode:80},KeyQ:{code:"KeyQ",keyCode:81},KeyR:{code:"KeyR",keyCode:82},KeyS:{code:"KeyS",keyCode:83},KeyT:{code:"KeyT",keyCode:84},KeyU:{code:"KeyU",keyCode:85},KeyV:{code:"KeyV",keyCode:86},KeyW:{code:"KeyW",keyCode:87},KeyX:{code:"KeyX",keyCode:88},KeyY:{code:"KeyY",keyCode:89},KeyZ:{code:"KeyZ",keyCode:90}};var s,c=i,n=function(){function e(e){this.lang=null,this.charsets={}}return e.prototype.getCode=function(e){if("number"==typeof e){var o=function(e){for(var o in i)if(i[o].keyCode===e)return i[o];return null}(e);null!==o&&(e=o.code)}return"string"==typeof e&&this.charsets[e]?e:null},e.prototype.getChar=function(e,o){if(this.charsets[e]){var t={code:e,char:this.charsets[e].base,compose:this.charsets[e].compose};return o&&o.shiftKey&&this.charsets[e].mod&&(t.char=this.charsets[e].mod),t}return null},e}(),d=(s=function(e,o){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var t in o)o.hasOwnProperty(t)&&(e[t]=o[t])})(e,o)},function(e,o){function t(){this.constructor=e}s(e,o),e.prototype=null===o?Object.create(o):(t.prototype=o.prototype,new t)}),r=[{code:c.Backquote.code,base:"`",mod:"~"},{code:c.Minus.code,base:"-",mod:"_"},{code:c.Equal.code,base:"=",mod:"+"},{code:c.BracketLeft.code,base:"[",mod:"{"},{code:c.BracketRight.code,base:"]",mod:"}"},{code:c.Backslash.code,base:"\\",mod:"|"},{code:c.Semicolon.code,base:";",mod:":"},{code:c.Quote.code,base:"'",mod:'"'},{code:c.Comma.code,base:",",mod:"<"},{code:c.Period.code,base:".",mod:">"},{code:c.Slash.code,base:"/",mod:"?"},{code:c.CapsLock.code},{code:c.Space.code},{code:c.ArrowLeft.code},{code:c.ArrowUp.code},{code:c.ArrowRight.code},{code:c.ArrowDown.code},{code:c.Backspace.code},{code:c.Delete.code},{code:c.Home.code},{code:c.End.code},{code:c.Digit1.code,base:"1",mod:"!"},{code:c.Digit2.code,base:"2",mod:"@"},{code:c.Digit3.code,base:"3",mod:"#"},{code:c.Digit4.code,base:"4",mod:"$"},{code:c.Digit5.code,base:"5",mod:"%"},{code:c.Digit6.code,base:"6",mod:"^"},{code:c.Digit7.code,base:"7",mod:"&"},{code:c.Digit8.code,base:"8",mod:"*"},{code:c.Digit9.code,base:"9",mod:"("},{code:c.Digit0.code,base:"0",mod:")"},{code:c.KeyA.code,base:"a",mod:"A"},{code:c.KeyB.code,base:"b",mod:"B"},{code:c.KeyC.code,base:"c",mod:"C"},{code:c.KeyD.code,base:"d",mod:"D"},{code:c.KeyE.code,base:"e",mod:"E"},{code:c.KeyF.code,base:"f",mod:"F"},{code:c.KeyG.code,base:"g",mod:"G"},{code:c.KeyH.code,base:"h",mod:"H"},{code:c.KeyI.code,base:"i",mod:"I"},{code:c.KeyJ.code,base:"j",mod:"J"},{code:c.KeyK.code,base:"k",mod:"K"},{code:c.KeyL.code,base:"l",mod:"L"},{code:c.KeyM.code,base:"m",mod:"M"},{code:c.KeyN.code,base:"n",mod:"N"},{code:c.KeyO.code,base:"o",mod:"O"},{code:c.KeyP.code,base:"p",mod:"P"},{code:c.KeyQ.code,base:"q",mod:"q"},{code:c.KeyR.code,base:"r",mod:"R"},{code:c.KeyS.code,base:"s",mod:"S"},{code:c.KeyT.code,base:"t",mod:"T"},{code:c.KeyU.code,base:"u",mod:"U"},{code:c.KeyV.code,base:"v",mod:"V"},{code:c.KeyW.code,base:"w",mod:"W"},{code:c.KeyX.code,base:"x",mod:"X"},{code:c.KeyY.code,base:"y",mod:"Y"},{code:c.KeyZ.code,base:"z",mod:"Z"}];var a=function(e){function o(o){var t,i=e.call(this,o)||this;return i.lang="en",i.charsets=(t={},r.forEach(function(e){t[e.code]=e}),t),i}return d(o,e),o.prototype.getChar=function(e,o){if(this.charsets[e]){var t={code:e,char:this.charsets[e].base,compose:this.charsets[e].compose};return o&&o.shiftKey&&(t.char=this.charsets[e].mod),o&&o.capslock&&t.char.match(/[a-zA-Z]/g)&&(t.char=this.charsets[e].mod),t}return null},o}(n),h=function(){var e=function(o,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var t in o)o.hasOwnProperty(t)&&(e[t]=o[t])})(o,t)};return function(o,t){function i(){this.constructor=o}e(o,t),o.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),u=[{code:c.Backquote.code,base:"`",mod:"~"},{code:c.Minus.code,base:"-",mod:"_"},{code:c.Equal.code,base:"=",mod:"+"},{code:c.BracketLeft.code,base:"[",mod:"{"},{code:c.BracketRight.code,base:"]",mod:"}"},{code:c.Backslash.code,base:"\\",mod:"|"},{code:c.Semicolon.code,base:";",mod:":"},{code:c.Quote.code,base:"'",mod:'"'},{code:c.Comma.code,base:",",mod:"<"},{code:c.Period.code,base:".",mod:">"},{code:c.Slash.code,base:"/",mod:"?"},{code:c.CapsLock.code},{code:c.Space.code},{code:c.ArrowLeft.code},{code:c.ArrowUp.code},{code:c.ArrowRight.code},{code:c.ArrowDown.code},{code:c.Backspace.code},{code:c.Delete.code},{code:c.Home.code},{code:c.End.code},{code:c.Digit1.code,base:"1",mod:"!"},{code:c.Digit2.code,base:"2",mod:"@"},{code:c.Digit3.code,base:"3",mod:"#"},{code:c.Digit4.code,base:"4",mod:"$"},{code:c.Digit5.code,base:"5",mod:"%"},{code:c.Digit6.code,base:"6",mod:"^"},{code:c.Digit7.code,base:"7",mod:"&"},{code:c.Digit8.code,base:"8",mod:"*"},{code:c.Digit9.code,base:"9",mod:"("},{code:c.Digit0.code,base:"0",mod:")"},{code:c.KeyA.code,base:"ㅁ",mod:null,compose:!0},{code:c.KeyB.code,base:"ㅠ",mod:null,compose:!0},{code:c.KeyC.code,base:"ㅊ",mod:null,compose:!0},{code:c.KeyD.code,base:"ㅇ",mod:null,compose:!0},{code:c.KeyE.code,base:"ㄷ",mod:"ㄸ",compose:!0},{code:c.KeyF.code,base:"ㄹ",mod:null,compose:!0},{code:c.KeyG.code,base:"ㅎ",mod:null,compose:!0},{code:c.KeyH.code,base:"ㅗ",mod:null,compose:!0},{code:c.KeyI.code,base:"ㅑ",mod:null,compose:!0},{code:c.KeyJ.code,base:"ㅓ",mod:null,compose:!0},{code:c.KeyK.code,base:"ㅏ",mod:null,compose:!0},{code:c.KeyL.code,base:"ㅣ",mod:null,compose:!0},{code:c.KeyM.code,base:"ㅡ",mod:null,compose:!0},{code:c.KeyN.code,base:"ㅜ",mod:null,compose:!0},{code:c.KeyO.code,base:"ㅐ",mod:"ㅒ",compose:!0},{code:c.KeyP.code,base:"ㅔ",mod:"ㅖ",compose:!0},{code:c.KeyQ.code,base:"ㅂ",mod:"ㅃ",compose:!0},{code:c.KeyR.code,base:"ㄱ",mod:"ㄲ",compose:!0},{code:c.KeyS.code,base:"ㄴ",mod:null,compose:!0},{code:c.KeyT.code,base:"ㅅ",mod:"ㅆ",compose:!0},{code:c.KeyU.code,base:"ㅕ",mod:null,compose:!0},{code:c.KeyV.code,base:"ㅍ",mod:null,compose:!0},{code:c.KeyW.code,base:"ㅈ",mod:"ㅉ",compose:!0},{code:c.KeyX.code,base:"ㅌ",mod:null,compose:!0},{code:c.KeyY.code,base:"ㅛ",mod:null,compose:!0},{code:c.KeyZ.code,base:"ㅋ",mod:null,compose:!0}];var l={en:a,ko:function(e){function o(o){var t,i=e.call(this,o)||this;return i.lang="ko",i.charsets=(t={},u.forEach(function(e){t[e.code]=e}),t),i}return h(o,e),o}(n)},p=function(e){if(!l[e])throw new Error("Keyboard Language not found.");return new l[e]},m=[12593,12594,12596,12599,12600,12601,12609,12610,12611,12613,12614,12615,12616,12617,12618,12619,12620,12621,12622],y=[0,12593,12594,12595,12596,12597,12598,12599,12601,12602,12603,12604,12605,12606,12607,12608,12609,12610,12612,12613,12614,12615,12616,12618,12619,12620,12621,12622],f=[0,0,0,0,0,0,0,0,0,800,801,820,0,0,1304,1305,1320,0,0,1820],g=[0,0,0,119,0,422,427,0,0,801,816,817,819,825,826,827,0,0,1719,0,0],C=44032,b=12623,K=19,v=21,P=28,k=588,D=11172,w={en:{id:"en",compose:function(e){return e},decompose:function(e){return e}},ko:{id:"ko",compose:function(e){var o=e.length;if(0===o)return"";for(var t,i,s,c,n,d,r,a=m,h=y,u=b,l=C,p=v,D=P,w=k,S=K,A=g,E=f,L=e.charCodeAt(0),M=String.fromCharCode(L),x=1;x<o;++x)if(t=e.charCodeAt(x),-1!==(i=a.indexOf(L))&&0<=(s=t-u)&&s<p)L=l+(i*p+s)*D,M=M.slice(0,M.length-1)+String.fromCharCode(L);else{if(0<=(r=L-l)&&r<11145&&r%D==0){if(-1!==(n=h.indexOf(t))){L+=n,M=M.slice(0,M.length-1)+String.fromCharCode(L);continue}if(s=r%w/D,(c=E.indexOf(100*s+(t-u)))>0){L+=(c-s)*D,M=M.slice(0,M.length-1)+String.fromCharCode(L);continue}}if(0<=r&&r<11172&&r%D!=0){if(n=r%D,0<=(s=t-u)&&s<p){if(0<=(i=a.indexOf(h[n]))&&i<S){M=M.slice(0,M.length-1)+String.fromCharCode(L-n),L=l+(i*p+s)*D,M+=String.fromCharCode(L);continue}if(n<A.length&&0!==A[n]){M=M.slice(0,M.length-1)+String.fromCharCode(L-n+Math.floor(A[n]/100)),L=l+(a.indexOf(h[A[n]%100])*p+s)*D,M+=String.fromCharCode(L);continue}}if((d=A.indexOf(100*n+h.indexOf(t)))>0){L=L+d-n,M=M.slice(0,M.length-1)+String.fromCharCode(L);continue}}L=t,M+=String.fromCharCode(t)}return M},decompose:function(e){for(var o,t,i,s,c,n=m,d=y,r=b,a=C,h=P,u=k,l=D,p=e.length,f="",g=0;g<p;g++)(t=(o=e.charCodeAt(g))-a)<0||t>=l?f+=String.fromCharCode(o):(i=n[Math.floor(t/u)],s=r+t%u/h,c=d[t%h],f+=String.fromCharCode(i,s),0!==c&&(f+=String.fromCharCode(c)));return f}}},S=function(){return function(e){if(!w[e])throw new Error("IME Language not found.");this.lang=e,this.composer=w[e]}}();var A={getCaretCoord:function(e,o){e.offsetLeft,e.offsetTop;for(var t=document.createElement("div"),i=getComputedStyle(e),s=0,c=i;s<c.length;s++){var n=c[s];t.style[n]=i[n]}var d="INPUT"===e.tagName?e.value.replace(/ /g,"."):e.value,r=d.substr(0,o);t.textContent=r,"TEXTAREA"===e.tagName&&(t.style.height="auto"),"INPUT"===e.tagName&&(t.style.width="auto");var a=document.createElement("span");a.textContent=d.substr(o)||".",t.appendChild(a),document.body.appendChild(t);var h=a.offsetLeft,u=a.offsetTop;return document.body.removeChild(t),{x:h,y:u}},getBrowser:function(){return navigator?-1!=(navigator.userAgent.indexOf("Opera")||navigator.userAgent.indexOf("OPR"))?"Opera":-1!=navigator.userAgent.indexOf("Chrome")?"Chrome":-1!=navigator.userAgent.indexOf("Safari")?"Safari":-1!=navigator.userAgent.indexOf("Firefox")?"Firefox":-1!=navigator.userAgent.indexOf("MSIE")||1==!!document.documentMode?"IE":null:null},getClipboardText:function(e){var o="";return e.clipboardData&&e.clipboardData.getData&&(o=e.clipboardData.getData("text/plain")),window.clipboardData&&window.clipboardData.getData&&(o=window.clipboardData.getData("Text")),o}},E=function(){return(E=Object.assign||function(e){for(var o,t=1,i=arguments.length;t<i;t++)for(var s in o=arguments[t])Object.prototype.hasOwnProperty.call(o,s)&&(e[s]=o[s]);return e}).apply(this,arguments)},L={lang:"en",value:"",caretPos:{startPos:0,endPos:0,direction:null}},M=function(){function e(e){var o,t;e&&(e=E({},L,e)),this.lang=e.lang,this.pattern=e.pattern,this.Keyboard=p(this.lang),this.IME=new S(e.lang),this.setInput(e.input),this.value=e.value,this.caretPos={startPos:e.caretPos.startPos,endPos:e.caretPos.endPos,direction:null},this.composing=null,this.capslock=!1,this.commands=((o={})[c.KeyA.code]=[{mods:["ctrlKey"],action:this.selectWholeValue.bind(this)}],o[c.Space.code]=[{mods:[],action:this.onSpace.bind(this)}],o[c.Backspace.code]=[{mods:[],action:this.onBackspace.bind(this)}],o[c.Delete.code]=[{mods:[],action:this.onDelete.bind(this)}],o[c.CapsLock.code]=[{mods:[],action:this.onCapsLock.bind(this)}],o[c.ArrowUp.code]=[{mods:[],action:this.onMoveCaret.bind(this)}],o[c.ArrowRight.code]=[{mods:[],action:this.onMoveCaret.bind(this)}],o[c.ArrowDown.code]=[{mods:[],action:this.onMoveCaret.bind(this)}],o[c.ArrowLeft.code]=[{mods:[],action:this.onMoveCaret.bind(this)}],o[c.Home.code]=[{mods:[],action:this.onMoveCaret.bind(this)}],o[c.End.code]=[{mods:[],action:this.onMoveCaret.bind(this)}],o[c.KeyC.code]=[{mods:["ctrlKey"],action:function(){}}],o[c.KeyV.code]=[{mods:["ctrlKey"],action:this.onPaste.bind(this)}],o),this.notPreventCommands=((t={})[c.KeyC.code]=this.commands[c.KeyC.code],t[c.KeyV.code]=this.commands[c.KeyV.code],t)}return e.prototype.selectWholeValue=function(){this.setCaretPos(0,this.value.length)},e.prototype.getCaretPos=function(){return{startPos:this.caretPos.startPos,endPos:this.caretPos.endPos,direction:this.caretPos.direction}},e.prototype.setCaretPos=function(e,o,t){var i=this.value.length;e<0&&(e=0),e>i&&(e=i),void 0===o&&(o=e),o<0&&(o=0),e>o&&(e=o),o<0&&(o=e),o>i&&(o=i),this.caretPos.direction=t&&e!==o?t:null,this.caretPos.startPos=e,this.caretPos.endPos=o},e.prototype.insertChar=function(e){var o=this.value,t=o.length;if(this.pattern){var i=e.match(this.pattern);if(!i)return;e=i.join("")}this.value=o.substring(0,this.caretPos.startPos)+e+o.substring(this.caretPos.endPos,t),this.setCaretPos(this.caretPos.startPos+e.length),this.updateInput()},e.prototype.removeComposing=function(){return this.composing?(this.setCaretPos(this.composing.position,this.composing.position+this.composing.char.length),this.composing=null,this.removeSelection()):""},e.prototype.isMultipleSelection=function(){var e=this.getCaretPos();return e.startPos!==e.endPos},e.prototype.onSpace=function(){this.isMultipleSelection()?this.removeSelection():(this.composing=null,this.insertChar(" "))},e.prototype.onDelete=function(){if(this.isMultipleSelection())this.removeSelection();else{var e=this.getCaretPos().startPos;this.composing=null,this.setCaretPos(e,e+1),this.removeSelection()}},e.prototype.onBackspace=function(){if(this.isMultipleSelection())this.removeSelection();else{var e=this.getCaretPos().startPos;if(this.composing){var o=this.removeComposing(),t=this.IME.composer.decompose(o);if(1===t.length)return;var i=this.IME.composer.compose(t.slice(0,-1));return this.composing=this.createComposition(i,this.caretPos.startPos+(i.length-1)),void this.insertChar(this.composing.char)}this.setCaretPos(e-1,e),this.removeSelection()}},e.prototype.onMoveCaret=function(e,o){var t=this.getCaretPos(),i=t.startPos,s=t.endPos,n=t.direction;if(this.composing=null,e===c.ArrowRight.code){if(o.ctrlKey){var d="left"===n?i:s;return(a=(r=this.value.substr(d,this.value.length)).match(/[^ .!@#]+/gi))&&(d=this.value.indexOf(a[0],d)+a[0].length,i="left"===n?d:i,s="left"===n?s:d,n=n||"right"),this.setCaretPos(o.shiftKey?i:s,s,n)}return i===s||o.shiftKey?(o.shiftKey?(i="left"===n?i+1:i,s="left"===n?s:s+1,n=n||"right"):(i=s+=1,n=null),this.setCaretPos(i,s,n)):this.setCaretPos(s)}if(e===c.ArrowLeft.code){if(o.ctrlKey){var r,a;d="right"===n?s:i;return(a=(r=this.value.substr(0,d)).match(/[^ .!@#]+/gi))&&(d=r.lastIndexOf(a[a.length-1]),i="right"===n?i:d,s="right"===n?d:s,n=n||"left"),this.setCaretPos(i,o.shiftKey?s:i,n)}return i===s||o.shiftKey?(o.shiftKey?(i="right"===n?i:i-1,s="right"===n?s-1:s,n=n||"left"):(s=i-=1,n=null),this.setCaretPos(i,s,n)):this.setCaretPos(i)}return e===c.ArrowUp.code?o.shiftKey?this.setCaretPos(0,s):this.setCaretPos(0):e===c.ArrowDown.code?o.shiftKey?this.setCaretPos(i,this.value.length):this.setCaretPos(this.value.length):e===c.Home.code?o.shiftKey?this.setCaretPos(0,s):this.setCaretPos(0):e===c.End.code?o.shiftKey?this.setCaretPos(i,this.value.length):this.setCaretPos(this.value.length):void 0},e.prototype.onInputInput=function(e){var o=this.input,t=o.selectionStart,i=o.selectionEnd,s=o.value;this.input.value=s.substr(0,t)+s.substr(i,s.length),this.input.selectionStart=t,this.input.selectionEnd=t},e.prototype.onCompositionstart=function(e){this.input.blur(),requestAnimationFrame(this.updateInput.bind(this))},e.prototype.onCompositionend=function(e){this.composing=null},e.prototype.updateCaretPosFromInput=function(){var e=this.getCaretPos(),o=e.startPos,t=e.endPos,i=this;requestAnimationFrame(function(){var e=i.input,s=e.selectionStart,c=e.selectionEnd;o===s&&t===c||(i.setCaretPos(s,c),i.composing=null)})},e.prototype.onPaste=function(e){e.preventDefault(),this.insertChar(A.getClipboardText(e))},e.prototype.onInputMousedown=function(){this.composing=null,document.addEventListener("mouseup",this.updateCaretPosFromInput.bind(this),{once:!0})},e.prototype.setInput=function(e){if(e){if("object"!=typeof e||!(e instanceof HTMLInputElement))throw new Error("HTMLInputElement is required");if(void 0!==e.GhostKeyboard)throw new Error("HTMLInputElement has already Ghost keyboard attached.");e.GhostKeyboard=!0,this.input=e,this.input.setAttribute("autocomplete","off"),this.input.addEventListener("keydown",this.event.bind(this)),this.input.addEventListener("paste",this.onPaste.bind(this)),"Safari"===A.getBrowser()?this.input.addEventListener("beforeinput",this.onInputInput.bind(this)):(this.input.addEventListener("compositionupdate",this.onCompositionstart.bind(this)),this.input.addEventListener("compositionend",this.onCompositionend.bind(this))),this.input.addEventListener("mousedown",this.onInputMousedown.bind(this))}},e.prototype.updateInput=function(){if(this.input){this.input.value=this.value,this.input.focus(),this.input.selectionStart=this.caretPos.startPos,this.input.selectionEnd=this.caretPos.endPos;var e=A.getCaretCoord(this.input,this.caretPos.startPos),o=this.input.scrollLeft,t=this.input.scrollLeft+this.input.clientWidth;(e.x<o||e.x>t)&&(this.input.scrollLeft=e.x-this.input.clientWidth/2)}},e.prototype.removeSelection=function(){var e=this.getCaretPos(),o=e.startPos,t=e.endPos,i=this.value,s=i.slice(o,t);return this.value=i.slice(0,o)+i.slice(t),this.setCaretPos(o),this.composing=null,s},e.prototype.normalizeMods=function(e){var o={};return["ctrlKey","altKey","shiftKey","metaKey"].forEach(function(t){o[t]=!1,e&&e[t]&&(o[t]=e[t])}),e&&e.metaKey&&(o.ctrlKey=!0),o.capslock=this.capslock,o},e.prototype.createComposition=function(e,o){return{char:e,position:o}},e.prototype.onCapsLock=function(){this.capslock=!this.capslock},e.prototype.getCommandAction=function(e,o,t){var i=null;if(e[o])for(var s=e[o],c=0;c<s.length;c++){if(0===s[c].mods.filter(function(e){return!0!==t[e]}).length){i=s[c].action;break}}return i},e.prototype.filterPattern=function(){if(this.pattern){var e=this.getCaretPos(),o=e.startPos,t=(e.endPos,new RegExp("[^"+this.pattern.source+"]","g")),i=this.value.substr(0,o),s=i.replace(t,"");this.value=this.value.replace(t,""),i.length!==s.length&&this.setCaretPos(o-(i.length-s.length))}},e.prototype.executeKey=function(e,o){o=this.normalizeMods(o);var t=this.getCommandAction(this.commands,e,o);if(t)return t(e,o),this.updateInput(),this.value;var i=this.Keyboard.getChar(e,o);if(!i||!i.char)return this.value;var s=i.char;if(this.composing&&i.compose){var c=this.removeComposing();s=this.IME.composer.compose(c+s)}return this.composing=i.compose?this.createComposition(s.charAt(s.length-1),this.caretPos.startPos+(s.length-1)):null,this.insertChar(s),this.value},e.prototype.setValue=function(e){this.value=e,this.setCaretPos(0)},e.prototype.event=function(e){if("object"!=typeof e||!e.type)throw new Error("The event have to be a KeyboardEvent.");if("keydown"===e.type){var o=this.Keyboard.getCode(e.code?e.code:e.which);if(!o)return;var t=this.normalizeMods(e);if(e.getModifierState&&(this.capslock=e.getModifierState("CapsLock"),t.capslock=this.capslock),this.getCommandAction(this.notPreventCommands,o,t))return;return e.preventDefault(),this.executeKey(o,t)}},e.prototype.type=function(e,o){var t=this.Keyboard.getCode(e);return this.executeKey(t,o)},e}();function x(e){return new M(e)}t.d(o,"GhostKeyboard",function(){return x});o.default=x}])});
=======
!function(e,o){if("object"==typeof exports&&"object"==typeof module)module.exports=o();else if("function"==typeof define&&define.amd)define([],o);else{var t=o();for(var i in t)("object"==typeof exports?exports:e)[i]=t[i]}}(window,function(){return function(e){var o={};function t(i){if(o[i])return o[i].exports;var s=o[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,t),s.l=!0,s.exports}return t.m=e,t.c=o,t.d=function(e,o,i){t.o(e,o)||Object.defineProperty(e,o,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,o){if(1&o&&(e=t(e)),8&o)return e;if(4&o&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&o&&"string"!=typeof e)for(var s in e)t.d(i,s,function(o){return e[o]}.bind(null,s));return i},t.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(o,"a",o),o},t.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},t.p="",t(t.s=0)}([function(e,o,t){"use strict";t.r(o);var i={Backquote:{code:"Backquote",keyCode:192},Minus:{code:"Minus",keyCode:189},Equal:{code:"Equal",keyCode:187},BracketLeft:{code:"BracketLeft",keyCode:219},BracketRight:{code:"BracketRight",keyCode:221},Backslash:{code:"Backslash",keyCode:220},Semicolon:{code:"Semicolon",keyCode:186},Quote:{code:"Quote",keyCode:222},Comma:{code:"Comma",keyCode:188},Period:{code:"Period",keyCode:190},Slash:{code:"Slash",keyCode:191},AltLeft:{code:"AltLeft",keyCode:18},Home:{code:"Home",keyCode:36},End:{code:"End",keyCode:35},CapsLock:{code:"CapsLock",keyCode:20},ShiftLeft:{code:"ShiftLeft",keyCode:16},ShiftRight:{code:"ShiftRight",keyCode:16},Space:{code:"Space",keyCode:32},ArrowLeft:{code:"ArrowLeft",keyCode:37},ArrowUp:{code:"ArrowUp",keyCode:38},ArrowRight:{code:"ArrowRight",keyCode:39},ArrowDown:{code:"ArrowDown",keyCode:40},Backspace:{code:"Backspace",keyCode:8},Delete:{code:"Delete",keyCode:46},Tab:{code:"Tab",keyCode:9},Digit1:{code:"Digit1",keyCode:49},Digit2:{code:"Digit2",keyCode:50},Digit3:{code:"Digit3",keyCode:51},Digit4:{code:"Digit4",keyCode:52},Digit5:{code:"Digit5",keyCode:53},Digit6:{code:"Digit6",keyCode:54},Digit7:{code:"Digit7",keyCode:55},Digit8:{code:"Digit8",keyCode:56},Digit9:{code:"Digit9",keyCode:57},Digit0:{code:"Digit0",keyCode:48},KeyA:{code:"KeyA",keyCode:65},KeyB:{code:"KeyB",keyCode:66},KeyC:{code:"KeyC",keyCode:67},KeyD:{code:"KeyD",keyCode:68},KeyE:{code:"KeyE",keyCode:69},KeyF:{code:"KeyF",keyCode:70},KeyG:{code:"KeyG",keyCode:71},KeyH:{code:"KeyH",keyCode:72},KeyI:{code:"KeyI",keyCode:73},KeyJ:{code:"KeyJ",keyCode:74},KeyK:{code:"KeyK",keyCode:75},KeyL:{code:"KeyL",keyCode:76},KeyM:{code:"KeyM",keyCode:77},KeyN:{code:"KeyN",keyCode:78},KeyO:{code:"KeyO",keyCode:79},KeyP:{code:"KeyP",keyCode:80},KeyQ:{code:"KeyQ",keyCode:81},KeyR:{code:"KeyR",keyCode:82},KeyS:{code:"KeyS",keyCode:83},KeyT:{code:"KeyT",keyCode:84},KeyU:{code:"KeyU",keyCode:85},KeyV:{code:"KeyV",keyCode:86},KeyW:{code:"KeyW",keyCode:87},KeyX:{code:"KeyX",keyCode:88},KeyY:{code:"KeyY",keyCode:89},KeyZ:{code:"KeyZ",keyCode:90}};function s(e){return"number"==typeof e?function(e){for(var o in i)if(i[o].keyCode===e)return i[o].code;return null}(e):"string"==typeof e&&i[e]?i[e].code:null}var n=i,d=[{code:n.Backquote.code,base:"`",mod:"~"},{code:n.Minus.code,base:"-",mod:"_"},{code:n.Equal.code,base:"=",mod:"+"},{code:n.BracketLeft.code,base:"[",mod:"{"},{code:n.BracketRight.code,base:"]",mod:"}"},{code:n.Backslash.code,base:"\\",mod:"|"},{code:n.Semicolon.code,base:";",mod:":"},{code:n.Quote.code,base:"'",mod:'"'},{code:n.Comma.code,base:",",mod:"<"},{code:n.Period.code,base:".",mod:">"},{code:n.Slash.code,base:"/",mod:"?"},{code:n.CapsLock.code},{code:n.Space.code},{code:n.ArrowLeft.code},{code:n.ArrowUp.code},{code:n.ArrowRight.code},{code:n.ArrowDown.code},{code:n.Backspace.code},{code:n.Delete.code},{code:n.Home.code},{code:n.End.code},{code:n.Digit1.code,base:"1",mod:"!"},{code:n.Digit2.code,base:"2",mod:"@"},{code:n.Digit3.code,base:"3",mod:"#"},{code:n.Digit4.code,base:"4",mod:"$"},{code:n.Digit5.code,base:"5",mod:"%"},{code:n.Digit6.code,base:"6",mod:"^"},{code:n.Digit7.code,base:"7",mod:"&"},{code:n.Digit8.code,base:"8",mod:"*"},{code:n.Digit9.code,base:"9",mod:"("},{code:n.Digit0.code,base:"0",mod:")"},{code:n.KeyA.code,base:"a",mod:"A"},{code:n.KeyB.code,base:"b",mod:"B"},{code:n.KeyC.code,base:"c",mod:"C"},{code:n.KeyD.code,base:"d",mod:"D"},{code:n.KeyE.code,base:"e",mod:"E"},{code:n.KeyF.code,base:"f",mod:"F"},{code:n.KeyG.code,base:"g",mod:"G"},{code:n.KeyH.code,base:"h",mod:"H"},{code:n.KeyI.code,base:"i",mod:"I"},{code:n.KeyJ.code,base:"j",mod:"J"},{code:n.KeyK.code,base:"k",mod:"K"},{code:n.KeyL.code,base:"l",mod:"L"},{code:n.KeyM.code,base:"m",mod:"M"},{code:n.KeyN.code,base:"n",mod:"N"},{code:n.KeyO.code,base:"o",mod:"O"},{code:n.KeyP.code,base:"p",mod:"P"},{code:n.KeyQ.code,base:"q",mod:"Q"},{code:n.KeyR.code,base:"r",mod:"R"},{code:n.KeyS.code,base:"s",mod:"S"},{code:n.KeyT.code,base:"t",mod:"T"},{code:n.KeyU.code,base:"u",mod:"U"},{code:n.KeyV.code,base:"v",mod:"V"},{code:n.KeyW.code,base:"w",mod:"W"},{code:n.KeyX.code,base:"x",mod:"X"},{code:n.KeyY.code,base:"y",mod:"Y"},{code:n.KeyZ.code,base:"z",mod:"Z"}];var c,r=(c={},d.forEach(function(e){c[e.code]=e}),c),a=function(){function e(){this.lang="en",this.charsets=r}return e.prototype.getCode=function(e){var o=null;return" "===e?{code:n.Space.code}:(d.every(function(t){return t.base===e?(o={code:t.code},!1):t.mod!==e||(o={code:t.code,mods:{shiftKey:!0}},!1)}),o)},e.prototype.getChar=function(e,o){if(this.charsets[e]){var t={code:e,char:this.charsets[e].base,compose:this.charsets[e].compose};return o&&o.shiftKey&&(t.char=this.charsets[e].mod),o&&o.capslock&&t.char.match(/[a-zA-Z]/g)&&(t.char=this.charsets[e].mod),t}return null},e}(),h=[{code:n.Backquote.code,base:"`",mod:"~"},{code:n.Minus.code,base:"-",mod:"_"},{code:n.Equal.code,base:"=",mod:"+"},{code:n.BracketLeft.code,base:"[",mod:"{"},{code:n.BracketRight.code,base:"]",mod:"}"},{code:n.Backslash.code,base:"\\",mod:"|"},{code:n.Semicolon.code,base:";",mod:":"},{code:n.Quote.code,base:"'",mod:'"'},{code:n.Comma.code,base:",",mod:"<"},{code:n.Period.code,base:".",mod:">"},{code:n.Slash.code,base:"/",mod:"?"},{code:n.CapsLock.code},{code:n.Space.code},{code:n.ArrowLeft.code},{code:n.ArrowUp.code},{code:n.ArrowRight.code},{code:n.ArrowDown.code},{code:n.Backspace.code},{code:n.Delete.code},{code:n.Home.code},{code:n.End.code},{code:n.Digit1.code,base:"1",mod:"!"},{code:n.Digit2.code,base:"2",mod:"@"},{code:n.Digit3.code,base:"3",mod:"#"},{code:n.Digit4.code,base:"4",mod:"$"},{code:n.Digit5.code,base:"5",mod:"%"},{code:n.Digit6.code,base:"6",mod:"^"},{code:n.Digit7.code,base:"7",mod:"&"},{code:n.Digit8.code,base:"8",mod:"*"},{code:n.Digit9.code,base:"9",mod:"("},{code:n.Digit0.code,base:"0",mod:")"},{code:n.KeyA.code,base:"ㅁ",mod:null,compose:!0},{code:n.KeyB.code,base:"ㅠ",mod:null,compose:!0},{code:n.KeyC.code,base:"ㅊ",mod:null,compose:!0},{code:n.KeyD.code,base:"ㅇ",mod:null,compose:!0},{code:n.KeyE.code,base:"ㄷ",mod:"ㄸ",compose:!0},{code:n.KeyF.code,base:"ㄹ",mod:null,compose:!0},{code:n.KeyG.code,base:"ㅎ",mod:null,compose:!0},{code:n.KeyH.code,base:"ㅗ",mod:null,compose:!0},{code:n.KeyI.code,base:"ㅑ",mod:null,compose:!0},{code:n.KeyJ.code,base:"ㅓ",mod:null,compose:!0},{code:n.KeyK.code,base:"ㅏ",mod:null,compose:!0},{code:n.KeyL.code,base:"ㅣ",mod:null,compose:!0},{code:n.KeyM.code,base:"ㅡ",mod:null,compose:!0},{code:n.KeyN.code,base:"ㅜ",mod:null,compose:!0},{code:n.KeyO.code,base:"ㅐ",mod:"ㅒ",compose:!0},{code:n.KeyP.code,base:"ㅔ",mod:"ㅖ",compose:!0},{code:n.KeyQ.code,base:"ㅂ",mod:"ㅃ",compose:!0},{code:n.KeyR.code,base:"ㄱ",mod:"ㄲ",compose:!0},{code:n.KeyS.code,base:"ㄴ",mod:null,compose:!0},{code:n.KeyT.code,base:"ㅅ",mod:"ㅆ",compose:!0},{code:n.KeyU.code,base:"ㅕ",mod:null,compose:!0},{code:n.KeyV.code,base:"ㅍ",mod:null,compose:!0},{code:n.KeyW.code,base:"ㅈ",mod:"ㅉ",compose:!0},{code:n.KeyX.code,base:"ㅌ",mod:null,compose:!0},{code:n.KeyY.code,base:"ㅛ",mod:null,compose:!0},{code:n.KeyZ.code,base:"ㅋ",mod:null,compose:!0}];var u=function(){var e={};return h.forEach(function(o){e[o.code]=o}),e}(),l={en:a,ko:function(){function e(){this.lang="ko",this.charsets=u}return e.prototype.getCode=function(e){var o=null;return" "===e?{code:n.Space.code}:(h.every(function(t){return t.base===e?(o={code:t.code},!1):t.mod!==e||(o={code:t.code,mods:{shiftKey:!0}},!1)}),o)},e.prototype.getChar=function(e,o){if(this.charsets[e]){var t={code:e,char:this.charsets[e].base,compose:this.charsets[e].compose};return o&&o.shiftKey&&this.charsets[e].mod&&(t.char=this.charsets[e].mod),t}return null},e}()},p=function(){function e(){this.lang="en"}return e.prototype.compose=function(e){return e},e.prototype.decompose=function(e){return e},e}(),m={initial:[12593,12594,12596,12599,12600,12601,12609,12610,12611,12613,12614,12615,12616,12617,12618,12619,12620,12621,12622],finale:[0,12593,12594,12595,12596,12597,12598,12599,12601,12602,12603,12604,12605,12606,12607,12608,12609,12610,12612,12613,12614,12615,12616,12618,12619,12620,12621,12622],dMedial:[0,0,0,0,0,0,0,0,0,800,801,820,0,0,1304,1305,1320,0,0,1820],dFinale:[0,0,0,119,0,422,427,0,0,801,816,817,819,825,826,827,0,0,1719,0,0],SBase:44032,VBase:12623,LCount:19,VCount:21,TCount:28,NCount:588,SCount:11172};function y(e){return 0<=e-m.VBase}var f={en:p,ko:function(){function e(){this.lang="ko"}return e.prototype.compose=function(e){var o=e.length;if(0===o)return"";for(var t,i,s,n,d,c,r,a,h=m.initial,u=m.finale,l=m.VBase,p=m.SBase,f=m.VCount,C=m.TCount,g=m.NCount,b=m.LCount,K=m.dFinale,v=m.dMedial,k=e.charCodeAt(0),P=String.fromCharCode(k),S=1;S<o;++S)if(t=e.charCodeAt(S),a=k,-1!==m.initial.indexOf(a)&&y(t))k=p+((i=h.indexOf(k))*f+(s=t-l))*C,P=P.slice(0,P.length-1)+String.fromCharCode(k);else{if(0<=(r=k-p)&&r<11145&&r%C==0){if(-1!==(d=u.indexOf(t))){k+=d,P=P.slice(0,P.length-1)+String.fromCharCode(k);continue}if(s=r%g/C,(n=v.indexOf(100*s+(t-l)))>0){k+=(n-s)*C,P=P.slice(0,P.length-1)+String.fromCharCode(k);continue}}if(0<=r&&r<11172&&r%C!=0){if(d=r%C,0<=(s=t-l)&&s<f){if(0<=(i=h.indexOf(u[d]))&&i<b){P=P.slice(0,P.length-1)+String.fromCharCode(k-d),k=p+(i*f+s)*C,P+=String.fromCharCode(k);continue}if(d<K.length&&0!==K[d]){P=P.slice(0,P.length-1)+String.fromCharCode(k-d+Math.floor(K[d]/100)),k=p+(h.indexOf(u[K[d]%100])*f+s)*C,P+=String.fromCharCode(k);continue}}if((c=K.indexOf(100*d+u.indexOf(t)))>0){k=k+c-d,P=P.slice(0,P.length-1)+String.fromCharCode(k);continue}}k=t,P+=String.fromCharCode(t)}return P},e.prototype.decompose=function(e){for(var o,t,i,s,n,d=m.initial,c=m.finale,r=m.VBase,a=m.SBase,h=m.TCount,u=m.NCount,l=m.SCount,p=e.length,y="",f=0;f<p;f++)(t=(o=e.charCodeAt(f))-a)<0||t>=l?y+=String.fromCharCode(o):(i=d[Math.floor(t/u)],s=r+t%u/h,n=c[t%h],y+=String.fromCharCode(i,s),0!==n&&(y+=String.fromCharCode(n)));return y},e}()};var C={getCaretCoord:function(e,o){e.offsetLeft,e.offsetTop;for(var t=document.createElement("div"),i=getComputedStyle(e),s=0,n=i;s<n.length;s++){var d=n[s];t.style[d]=i[d]}var c="INPUT"===e.tagName?e.value.replace(/ /g,"."):e.value,r=c.substr(0,o);t.textContent=r,"TEXTAREA"===e.tagName&&(t.style.height="auto"),"INPUT"===e.tagName&&(t.style.width="auto");var a=document.createElement("span");a.textContent=c.substr(o)||".",t.appendChild(a),document.body.appendChild(t);var h=a.offsetLeft,u=a.offsetTop;return document.body.removeChild(t),{x:h,y:u}},getBrowser:function(){return navigator?-1!=(navigator.userAgent.indexOf("Opera")||navigator.userAgent.indexOf("OPR"))?"Opera":-1!=navigator.userAgent.indexOf("Chrome")?"Chrome":-1!=navigator.userAgent.indexOf("Safari")?"Safari":-1!=navigator.userAgent.indexOf("Firefox")?"Firefox":-1!=navigator.userAgent.indexOf("MSIE")||1==!!document.documentMode?"IE":null:null},getClipboardText:function(e){var o="";return e.clipboardData&&e.clipboardData.getData&&(o=e.clipboardData.getData("text/plain")),window.clipboardData&&window.clipboardData.getData&&(o=window.clipboardData.getData("Text")),o}},g=function(){return(g=Object.assign||function(e){for(var o,t=1,i=arguments.length;t<i;t++)for(var s in o=arguments[t])Object.prototype.hasOwnProperty.call(o,s)&&(e[s]=o[s]);return e}).apply(this,arguments)},b={lang:"en",value:"",caretPos:{startPos:0,endPos:0,direction:null}},K=function(){function e(e){var o,t;if(e&&(e=g({},b,e)),!l[e.lang])throw new Error("Keyboard language not compatible.");this.lang=e.lang,this.pattern=e.pattern,this.Keyboard=new l[this.lang],this.IME=new f[this.lang],this.setInput(e.input),this.value=e.value,this.caretPos={startPos:e.caretPos.startPos,endPos:e.caretPos.endPos,direction:null},this.composing=null,this.capslock=!1,this.commands=((o={})[n.KeyA.code]=[{mods:["ctrlKey"],action:this.selectWholeValue.bind(this)}],o[n.Space.code]=[{mods:[],action:this.onSpace.bind(this)}],o[n.Backspace.code]=[{mods:[],action:this.onBackspace.bind(this)}],o[n.Delete.code]=[{mods:[],action:this.onDelete.bind(this)}],o[n.CapsLock.code]=[{mods:[],action:this.onCapsLock.bind(this)}],o[n.ArrowUp.code]=[{mods:[],action:this.onMoveCaret.bind(this)}],o[n.ArrowRight.code]=[{mods:[],action:this.onMoveCaret.bind(this)}],o[n.ArrowDown.code]=[{mods:[],action:this.onMoveCaret.bind(this)}],o[n.ArrowLeft.code]=[{mods:[],action:this.onMoveCaret.bind(this)}],o[n.Home.code]=[{mods:[],action:this.onMoveCaret.bind(this)}],o[n.End.code]=[{mods:[],action:this.onMoveCaret.bind(this)}],o[n.KeyC.code]=[{mods:["ctrlKey"],action:this.onCopy.bind(this)}],o[n.KeyV.code]=[{mods:["ctrlKey"],action:this.onPaste.bind(this)}],o),this.notPreventCommands=((t={})[n.KeyC.code]=this.commands[n.KeyC.code],t[n.KeyV.code]=this.commands[n.KeyV.code],t)}return e.prototype.selectWholeValue=function(){this.setCaretPos(0,this.value.length)},e.prototype.getCaretPos=function(){return{startPos:this.caretPos.startPos,endPos:this.caretPos.endPos,direction:this.caretPos.direction}},e.prototype.setCaretPos=function(e,o,t){var i=this.value.length;e<0&&(e=0),e>i&&(e=i),void 0===o&&(o=e),o<0&&(o=0),e>o&&(e=o),o<0&&(o=e),o>i&&(o=i),this.caretPos.direction=t&&e!==o?t:null,this.caretPos.startPos=e,this.caretPos.endPos=o},e.prototype.insertChar=function(e){var o=this.value,t=o.length;if(this.pattern){var i=e.match(this.pattern);if(!i)return;e=i.join("")}this.value=o.substring(0,this.caretPos.startPos)+e+o.substring(this.caretPos.endPos,t),this.setCaretPos(this.caretPos.startPos+e.length),this.updateInput()},e.prototype.removeComposing=function(){return this.composing?(this.setCaretPos(this.composing.position,this.composing.position+this.composing.char.length),this.composing=null,this.removeSelection()):""},e.prototype.isMultipleSelection=function(){var e=this.getCaretPos();return e.startPos!==e.endPos},e.prototype.onSpace=function(){this.isMultipleSelection()?this.removeSelection():(this.composing=null,this.insertChar(" "))},e.prototype.onDelete=function(){if(this.isMultipleSelection())this.removeSelection();else{var e=this.getCaretPos().startPos;this.composing=null,this.setCaretPos(e,e+1),this.removeSelection()}},e.prototype.onBackspace=function(){if(this.isMultipleSelection())this.removeSelection();else{var e=this.getCaretPos().startPos;if(this.composing){var o=this.removeComposing(),t=this.IME.decompose(o);if(1===t.length)return;var i=this.IME.compose(t.slice(0,-1));return this.composing=this.createComposition(i,this.caretPos.startPos+(i.length-1)),void this.insertChar(this.composing.char)}this.setCaretPos(e-1,e),this.removeSelection()}},e.prototype.onMoveCaret=function(e,o){var t=this.getCaretPos(),i=t.startPos,s=t.endPos,d=t.direction;if(this.composing=null,e===n.ArrowRight.code){if(o.ctrlKey){var c="left"===d?i:s;return(a=(r=this.value.substr(c,this.value.length)).match(/[^ .!@#]+/gi))&&(c=this.value.indexOf(a[0],c)+a[0].length,i="left"===d?c:i,s="left"===d?s:c,d=d||"right"),this.setCaretPos(o.shiftKey?i:s,s,d)}return i===s||o.shiftKey?(o.shiftKey?(i="left"===d?i+1:i,s="left"===d?s:s+1,d=d||"right"):(i=s+=1,d=null),this.setCaretPos(i,s,d)):this.setCaretPos(s)}if(e===n.ArrowLeft.code){if(o.ctrlKey){var r,a;c="right"===d?s:i;return(a=(r=this.value.substr(0,c)).match(/[^ .!@#]+/gi))&&(c=r.lastIndexOf(a[a.length-1]),i="right"===d?i:c,s="right"===d?c:s,d=d||"left"),this.setCaretPos(i,o.shiftKey?s:i,d)}return i===s||o.shiftKey?(o.shiftKey?(i="right"===d?i:i-1,s="right"===d?s-1:s,d=d||"left"):(s=i-=1,d=null),this.setCaretPos(i,s,d)):this.setCaretPos(i)}return e===n.ArrowUp.code?o.shiftKey?this.setCaretPos(0,s):this.setCaretPos(0):e===n.ArrowDown.code?o.shiftKey?this.setCaretPos(i,this.value.length):this.setCaretPos(this.value.length):e===n.Home.code?o.shiftKey?this.setCaretPos(0,s):this.setCaretPos(0):e===n.End.code?o.shiftKey?this.setCaretPos(i,this.value.length):this.setCaretPos(this.value.length):void 0},e.prototype.onInputInput=function(e){var o=this.input,t=o.selectionStart,i=o.selectionEnd,s=o.value;this.input.value=s.substr(0,t)+s.substr(i,s.length),this.input.selectionStart=t,this.input.selectionEnd=t},e.prototype.onCompositionstart=function(e){this.input.blur(),requestAnimationFrame(this.updateInput.bind(this))},e.prototype.onCompositionend=function(e){this.composing=null},e.prototype.updateCaretPosFromInput=function(){var e=this.getCaretPos(),o=e.startPos,t=e.endPos,i=this;requestAnimationFrame(function(){var e=i.input,s=e.selectionStart,n=e.selectionEnd;o===s&&t===n||(i.setCaretPos(s,n),i.composing=null)})},e.prototype.onCopy=function(){var e=this.getCaretPos(),o=e.startPos,t=e.endPos;this.clipboard=this.value.substr(o,t)},e.prototype.onPaste=function(e){var o=this.clipboard;e&&e instanceof ClipboardEvent&&(e.preventDefault(),o=C.getClipboardText(e)),this.insertChar(o)},e.prototype.onInputMousedown=function(){this.composing=null,document.addEventListener("mouseup",this.updateCaretPosFromInput.bind(this),{once:!0})},e.prototype.setInput=function(e){if(e){if("object"!=typeof e||!(e instanceof HTMLInputElement))throw new Error("HTMLInputElement is required");if(void 0!==e.GhostKeyboard)throw new Error("HTMLInputElement has already Ghost keyboard attached.");e.GhostKeyboard=!0,this.input=e,this.input.setAttribute("autocomplete","off"),this.input.addEventListener("keydown",this.event.bind(this)),this.input.addEventListener("paste",this.onPaste.bind(this)),"Safari"===C.getBrowser()?this.input.addEventListener("beforeinput",this.onInputInput.bind(this)):(this.input.addEventListener("compositionupdate",this.onCompositionstart.bind(this)),this.input.addEventListener("compositionend",this.onCompositionend.bind(this))),this.input.addEventListener("mousedown",this.onInputMousedown.bind(this))}},e.prototype.updateInput=function(){if(this.input){this.input.value=this.value,this.input.focus(),this.input.selectionStart=this.caretPos.startPos,this.input.selectionEnd=this.caretPos.endPos;var e=C.getCaretCoord(this.input,this.caretPos.startPos),o=this.input.scrollLeft,t=this.input.scrollLeft+this.input.clientWidth;(e.x<o||e.x>t)&&(this.input.scrollLeft=e.x-this.input.clientWidth/2)}},e.prototype.removeSelection=function(){var e=this.getCaretPos(),o=e.startPos,t=e.endPos,i=this.value,s=i.slice(o,t);return this.value=i.slice(0,o)+i.slice(t),this.setCaretPos(o),this.composing=null,s},e.prototype.normalizeMods=function(e){var o={};return["ctrlKey","altKey","shiftKey","metaKey"].forEach(function(t){o[t]=!1,e&&e[t]&&(o[t]=e[t])}),e&&e.metaKey&&(o.ctrlKey=!0),o.capslock=this.capslock,o},e.prototype.createComposition=function(e,o){return{char:e,position:o}},e.prototype.onCapsLock=function(){this.capslock=!this.capslock},e.prototype.getCommandAction=function(e,o,t){var i=null;if(e[o])for(var s=e[o],n=0;n<s.length;n++){if(0===s[n].mods.filter(function(e){return!0!==t[e]}).length){i=s[n].action;break}}return i},e.prototype.filterPattern=function(){if(this.pattern){var e=this.getCaretPos(),o=e.startPos,t=(e.endPos,new RegExp("[^"+this.pattern.source+"]","g")),i=this.value.substr(0,o),s=i.replace(t,"");this.value=this.value.replace(t,""),i.length!==s.length&&this.setCaretPos(o-(i.length-s.length))}},e.prototype.executeKey=function(e,o){o=this.normalizeMods(o);var t=this.getCommandAction(this.commands,e,o);if(t)return t(e,o),this.updateInput(),this.value;var i=this.Keyboard.getChar(e,o);if(!i||!i.char)return this.value;var s=i.char;if(this.composing&&i.compose){var n=this.removeComposing();s=this.IME.compose(n+s)}return this.composing=i.compose?this.createComposition(s.charAt(s.length-1),this.caretPos.startPos+(s.length-1)):null,this.insertChar(s),this.value},e.prototype.setValue=function(e){this.value=e,this.setCaretPos(0)},e.prototype.changeLang=function(e){var o=this,t=this.value,i=this.IME.decompose(t).split("").map(function(e){return o.Keyboard.getCode(e)});this.lang=e,this.Keyboard=new l[e],this.IME=new f[e];var s=i.map(function(e){return o.Keyboard.getChar(e.code,e.mods)}).map(function(e){return e.code===n.Space.code?" ":e.char});this.value=this.IME.compose(s.join(""))},e.prototype.event=function(e){if("object"!=typeof e||!e.type)throw new Error("The event have to be a KeyboardEvent.");if("keydown"===e.type){var o=s(e.code?e.code:e.which);if(!o)return;var t=this.normalizeMods(e);if(e.getModifierState&&(this.capslock=e.getModifierState("CapsLock"),t.capslock=this.capslock),this.getCommandAction(this.notPreventCommands,o,t))return;return e.preventDefault(),this.executeKey(o,t)}},e.prototype.type=function(e,o){var t=s(e);return this.executeKey(t,o)},e}();function v(e){return new K(e)}t.d(o,"GhostKeyboard",function(){return v});o.default=v}])});
>>>>>>> Stashed changes
